CREATE OR REPLACE VIEW PMIS_RES.ViewA33v2
AS 
  SELECT 1 as StatusID,
		   'ВОДЯТ СЕ НА ОТЧЕТ' as StatusName,
		   1 as StatusOrder,
		   0 as MilReadinessID,
		   TO_CHAR('') as AdministrationGroup,
		   '1.' as RowNumber,
       0 as IsEmptyRow,
       NULL as IsMinistryOfDefence
	FROM dual

	UNION ALL

	SELECT 2 as StatusID,
		   'Доброволен резерв' as StatusName,
		   2 as StatusOrder,
		   0 as MilReadinessID,
		   TO_CHAR('') as AdministrationGroup,
		   '2.' as RowNumber,
       0 as IsEmptyRow,
       NULL as IsMinistryOfDefence
	FROM dual

	UNION ALL
    
    SELECT 3 as StatusID,
		   'Запасни на военен отчет' as StatusName,
		   3 as StatusOrder,
		   0 as MilReadinessID,
		   TO_CHAR('') as AdministrationGroup,
		   '3.' as RowNumber,
       0 as IsEmptyRow,
       NULL as IsMinistryOfDefence
	FROM dual

	UNION ALL
    
    SELECT 4 as StatusID,
		   'С мобилизационно назначение за в.ф. на ВС' as StatusName,
		   4 as StatusOrder,
		   0 as MilReadinessID,
		   TO_CHAR('') as AdministrationGroup,
		   '3.1.' as RowNumber,
       1 as IsEmptyRow,
       1 as IsMinistryOfDefence
	FROM dual
    
    UNION ALL

	SELECT 4 + DENSE_RANK() OVER (ORDER BY a.MilReadinessCmdType, a.MilReadinessID) as StatusID,
		   'С мобилизационно назначение – ' || LOWER(a.MilReadinessCmdType) as StatusName,
		   4 + DENSE_RANK() OVER (ORDER BY a.MilReadinessCmdType, a.MilReadinessID) as StatusOrder,
		   a.MilReadinessID,
		   TO_CHAR('') as AdministrationGroup,
		   '3.1.' || TO_CHAR(RANK() OVER (ORDER BY a.MilReadinessCmdType, a.MilReadinessID)) || '.' as RowNumber,
       0 as IsEmptyRow,
       1 as IsMinistryOfDefence
	FROM PMIS_RES.MilReadiness a
    WHERE a.MilReadinessCmdType IS NOT NULL

	UNION ALL
    
	SELECT 5 + (SELECT COUNT(*) FROM PMIS_RES.MilReadiness WHERE MilReadinessCmdType IS NOT NULL) as StatusID,
		   'Процент резерв с МН /брой/' as StatusName,
		   5 + (SELECT COUNT(*) FROM PMIS_RES.MilReadiness WHERE MilReadinessCmdType IS NOT NULL) as StatusOrder,
		   0 as MilReadinessID,
		   TO_CHAR('') as AdministrationGroup,
		   '3.1.' || TO_CHAR((SELECT COUNT(*) FROM PMIS_RES.MilReadiness WHERE MilReadinessCmdType IS NOT NULL) + 1) || '.' as RowNumber,
       0 as IsEmptyRow,
       1 as IsMinistryOfDefence
	FROM dual
    
    UNION ALL
    
	SELECT 6 + (SELECT COUNT(*) FROM PMIS_RES.MilReadiness WHERE MilReadinessCmdType IS NOT NULL) as StatusID,
		   'Доставят се направо (община-ППЗ)' as StatusName,
		   6 + (SELECT COUNT(*) FROM PMIS_RES.MilReadiness WHERE MilReadinessCmdType IS NOT NULL) as StatusOrder,
		   0 as MilReadinessID,
		   TO_CHAR('') as AdministrationGroup,
		   '3.1.' || TO_CHAR((SELECT COUNT(*) FROM PMIS_RES.MilReadiness WHERE MilReadinessCmdType IS NOT NULL) + 2) || '.' as RowNumber,
       0 as IsEmptyRow,
       1 as IsMinistryOfDefence
	FROM dual
    
    UNION ALL
    
	SELECT 7 + (SELECT COUNT(*) FROM PMIS_RES.MilReadiness WHERE MilReadinessCmdType IS NOT NULL) as StatusID,
		   'Доставят се чрез сборен пункт (сборен пукт на ОВО - ППЗ)' as StatusName,
		   7 + (SELECT COUNT(*) FROM PMIS_RES.MilReadiness WHERE MilReadinessCmdType IS NOT NULL) as StatusOrder,
		   0 as MilReadinessID,
		   TO_CHAR('') as AdministrationGroup,
		   '3.1.' || TO_CHAR((SELECT COUNT(*) FROM PMIS_RES.MilReadiness WHERE MilReadinessCmdType IS NOT NULL) + 3) || '.' as RowNumber,
       0 as IsEmptyRow,
       1 as IsMinistryOfDefence
	FROM dual
    
    UNION ALL
    
	SELECT 8 + (SELECT COUNT(*) FROM PMIS_RES.MilReadiness WHERE MilReadinessCmdType IS NOT NULL) as StatusID,
		   'Всичко с МН за в.ф. на въоръжените сили' as StatusName,
		   8 + (SELECT COUNT(*) FROM PMIS_RES.MilReadiness WHERE MilReadinessCmdType IS NOT NULL) as StatusOrder,
		   0 as MilReadinessID,
		   TO_CHAR('') as AdministrationGroup,
		   '' as RowNumber,
       0 as IsEmptyRow,
       1 as IsMinistryOfDefence
	FROM dual
    
    UNION ALL
    
	SELECT 9 + (SELECT COUNT(*) FROM PMIS_RES.MilReadiness WHERE MilReadinessCmdType IS NOT NULL) as StatusID,
		   'С МН за силите от системата за национална сигурност' as StatusName,
		   9 + (SELECT COUNT(*) FROM PMIS_RES.MilReadiness WHERE MilReadinessCmdType IS NOT NULL) as StatusOrder,
		   0 as MilReadinessID,
		   TO_CHAR('') as AdministrationGroup,
		   '3.2.' as RowNumber,
       1 as IsEmptyRow,
       0 as IsMinistryOfDefence
	FROM dual
   
	UNION ALL

	SELECT 9 + (SELECT COUNT(*) FROM PMIS_RES.MilReadiness WHERE MilReadinessCmdType IS NOT NULL) +  + a2.milRed_rank + a2.adm_rank  as StatusID,
		   'С МН за ' || a.AdministrationGroup || CASE WHEN a2.milreadinesscmdtype IS NULL
                                                  THEN ''
                                                  ELSE ' - ' || a2.milreadinesscmdtype  
                                              END as StatusName,
		   9 + (SELECT COUNT(*) FROM PMIS_RES.MilReadiness) + a2.milRed_rank + a2.adm_rank 
       
       as StatusOrder,
		   a2.milreadinessid as MilReadinessID,
		   a.AdministrationGroup,
		   '3.2.' || TO_CHAR((DENSE_RANK() OVER (ORDER BY a.AdministrationGroupSeq, a.AdministrationGroup))) || '.'
       || CASE WHEN a2.milRed_rank > 0 THEN TO_CHAR(a2.milRed_rank) || '.' ELSE '' END as RowNumber,
       0 as IsEmtpyRow,
       0 as IsMinistryOfDefence   
	FROM PMIS_ADM.Administrations a
  LEFT OUTER JOIN (
    SELECT a3.AdministrationGroupSeq,
           a3.AdministrationGroup, 
           a3.milreadinesscmdtype,
           a3.milreadinessid,
           DENSE_RANK()  OVER (PARTITION BY a3.AdministrationGroup, a3.AdministrationGroupSeq ORDER BY a3.AdministrationGroupSeq, a3.milreadinessid) - 1 as milRed_rank,
           RANK()  OVER (ORDER BY a3.AdministrationGroupSeq, a3.AdministrationGroup)  as adm_rank
    FROM (
      SELECT AdministrationGroupSeq,
             AdministrationGroup,
             '' as milreadinesscmdtype, 
             0 as milreadinessid
      FROM PMIS_ADM.Administrations 
      WHERE administrationgroup IS NOT NULL AND NVL(IsMinistryOfDefence, 0) = 0
      GROUP BY AdministrationGroupSeq, AdministrationGroup
      
      UNION 
      
      SELECT AdministrationGroupSeq,
             AdministrationGroup,
             mr.milreadinesscmdtype as milreadinesscmdtype, 
             mr.milreadinessid
      FROM PMIS_ADM.Administrations ad    
      LEFT OUTER JOIN PMIS_RES.MilReadiness mr ON mr.administrationid = ad.administrationid OR mr.administrationid IS NULL
      WHERE administrationgroup IS NOT NULL AND NVL(IsMinistryOfDefence, 0) = 0
      GROUP BY AdministrationGroupSeq, AdministrationGroup, mr.milreadinesscmdtype, mr.milreadinessid
      HAVING MAX(ad.reporta33breakdown)  > 0) a3
    GROUP BY a3.AdministrationGroupSeq, a3.AdministrationGroup, a3.milreadinesscmdtype, a3.milreadinessid
  ) a2 ON a2.AdministrationGroup = a.AdministrationGroup    
  WHERE a.AdministrationGroup IS NOT NULL AND NVL(a.IsMinistryOfDefence, 0) = 0
  GROUP BY a.AdministrationGroupSeq, a.AdministrationGroup,  a2.milreadinessid, a2.milreadinesscmdtype, a2.milRed_rank, a2.adm_rank
  
	UNION ALL

	SELECT 10 + (SELECT COUNT(*) FROM PMIS_RES.MilReadiness WHERE MilReadinessCmdType IS NOT NULL) +
        (SELECT COUNT(*)
         FROM (SELECT AdministrationGroup 
               FROM PMIS_ADM.Administrations 
               WHERE AdministrationGroup IS NOT NULL 
                     AND NVL(IsMinistryOfDefence, 0) = 0 
               GROUP BY AdministrationGroup) adm_cnt) +
        (SELECT COUNT(*)
         FROM (  
            SELECT a.administrationgroup, mr.milreadinesscmdtype
            FROM PMIS_ADM.Administrations a
            INNER JOIN PMIS_RES.MilReadiness mr ON mr.administrationid = a.administrationid OR mr.administrationid is null
            WHERE administrationgroup IS NOT NULL
            GROUP BY a.administrationgroup, mr.milreadinesscmdtype
         HAVING MAX(reporta33breakdown)  > 0) adm_readiness_cnt )  as StatusID,
		   'Процент резерв с МН /брой/' as StatusName,
		   10 + (SELECT COUNT(*) FROM PMIS_RES.MilReadiness WHERE MilReadinessCmdType IS NOT NULL)  +
        (SELECT COUNT(*)
         FROM (SELECT AdministrationGroup 
               FROM PMIS_ADM.Administrations 
               WHERE AdministrationGroup IS NOT NULL 
                     AND NVL(IsMinistryOfDefence, 0) = 0 
               GROUP BY AdministrationGroup) adm_cnt) +
        (SELECT COUNT(*)
         FROM (  
            SELECT a.administrationgroup, mr.milreadinesscmdtype
            FROM PMIS_ADM.Administrations a
            INNER JOIN PMIS_RES.MilReadiness mr ON mr.administrationid = a.administrationid OR mr.administrationid is null
            WHERE administrationgroup IS NOT NULL
            GROUP BY a.administrationgroup, mr.milreadinesscmdtype
         HAVING MAX(reporta33breakdown)  > 0) adm_readiness_cnt ) as StatusOrder,
		   0 as MilReadinessID,
		   TO_CHAR('') as AdministrationGroup,
       '3.2.' || TO_CHAR((SELECT COUNT(DISTINCT AdministrationGroup) FROM PMIS_ADM.Administrations WHERE AdministrationGroup IS NOT NULL AND NVL(IsMinistryOfDefence, 0) = 0) + 1) || '.' as RowNumber,
       0 as IsEmtpyRow,
       0 as IsMinistryOfDefence
	FROM dual
    
    UNION ALL

	SELECT 11 + (SELECT COUNT(*) FROM PMIS_RES.MilReadiness WHERE MilReadinessCmdType IS NOT NULL)  +
        (SELECT COUNT(*)
         FROM (SELECT AdministrationGroup 
               FROM PMIS_ADM.Administrations 
               WHERE AdministrationGroup IS NOT NULL 
                     AND NVL(IsMinistryOfDefence, 0) = 0 
               GROUP BY AdministrationGroup) adm_cnt) +
        (SELECT COUNT(*)
         FROM (  
            SELECT a.administrationgroup, mr.milreadinesscmdtype
            FROM PMIS_ADM.Administrations a
            INNER JOIN PMIS_RES.MilReadiness mr ON mr.administrationid = a.administrationid OR mr.administrationid is null
            WHERE administrationgroup IS NOT NULL
            GROUP BY a.administrationgroup, mr.milreadinesscmdtype
         HAVING MAX(reporta33breakdown)  > 0) adm_readiness_cnt ) as StatusID,
		   'Доставят се направо (община-ППЗ)' as StatusName,
		   11 + (SELECT COUNT(*) FROM PMIS_RES.MilReadiness WHERE MilReadinessCmdType IS NOT NULL) +  +
        (SELECT COUNT(*)
         FROM (SELECT AdministrationGroup 
               FROM PMIS_ADM.Administrations 
               WHERE AdministrationGroup IS NOT NULL 
                     AND NVL(IsMinistryOfDefence, 0) = 0 
               GROUP BY AdministrationGroup) adm_cnt) +
        (SELECT COUNT(*)
         FROM (  
            SELECT a.administrationgroup, mr.milreadinesscmdtype
            FROM PMIS_ADM.Administrations a
            INNER JOIN PMIS_RES.MilReadiness mr ON mr.administrationid = a.administrationid OR mr.administrationid is null
            WHERE administrationgroup IS NOT NULL
            GROUP BY a.administrationgroup, mr.milreadinesscmdtype
         HAVING MAX(reporta33breakdown)  > 0) adm_readiness_cnt ) as StatusOrder,
		   0 as MilReadinessID,
		   TO_CHAR('') as AdministrationGroup,
       '3.2.' || TO_CHAR((SELECT COUNT(DISTINCT AdministrationGroup) FROM PMIS_ADM.Administrations WHERE AdministrationGroup IS NOT NULL AND NVL(IsMinistryOfDefence, 0) = 0) + 2) || '.' as RowNumber,
       0 as IsEmtpyRow,
       0 as IsMinistryOfDefence
	FROM dual
    
    UNION ALL

	SELECT 12 + (SELECT COUNT(*) FROM PMIS_RES.MilReadiness WHERE MilReadinessCmdType IS NOT NULL) +  +
        (SELECT COUNT(*)
         FROM (SELECT AdministrationGroup 
               FROM PMIS_ADM.Administrations 
               WHERE AdministrationGroup IS NOT NULL 
                     AND NVL(IsMinistryOfDefence, 0) = 0 
               GROUP BY AdministrationGroup) adm_cnt) +
        (SELECT COUNT(*)
         FROM (  
            SELECT a.administrationgroup, mr.milreadinesscmdtype
            FROM PMIS_ADM.Administrations a
            INNER JOIN PMIS_RES.MilReadiness mr ON mr.administrationid = a.administrationid OR mr.administrationid is null
            WHERE administrationgroup IS NOT NULL
            GROUP BY a.administrationgroup, mr.milreadinesscmdtype
         HAVING MAX(reporta33breakdown)  > 0) adm_readiness_cnt ) as StatusID,
		   'Доставят се чрез сборен пункт (сборен пукт на ОВО ППЗ)' as StatusName,
		   12 + (SELECT COUNT(*) FROM PMIS_RES.MilReadiness WHERE MilReadinessCmdType IS NOT NULL)  +
        (SELECT COUNT(*)
         FROM (SELECT AdministrationGroup 
               FROM PMIS_ADM.Administrations 
               WHERE AdministrationGroup IS NOT NULL 
                     AND NVL(IsMinistryOfDefence, 0) = 0 
               GROUP BY AdministrationGroup) adm_cnt) +
        (SELECT COUNT(*)
         FROM (  
            SELECT a.administrationgroup, mr.milreadinesscmdtype
            FROM PMIS_ADM.Administrations a
            INNER JOIN PMIS_RES.MilReadiness mr ON mr.administrationid = a.administrationid OR mr.administrationid is null
            WHERE administrationgroup IS NOT NULL
            GROUP BY a.administrationgroup, mr.milreadinesscmdtype
         HAVING MAX(reporta33breakdown)  > 0) adm_readiness_cnt ) as StatusOrder,
		   0 as MilReadinessID,
		   TO_CHAR('') as AdministrationGroup,
       '3.2.' || TO_CHAR((SELECT COUNT(DISTINCT AdministrationGroup) FROM PMIS_ADM.Administrations WHERE AdministrationGroup IS NOT NULL AND NVL(IsMinistryOfDefence, 0) = 0) + 3) || '.' as RowNumber,
       0 as IsEmtpyRow,
       0 as IsMinistryOfDefence
	FROM dual
    
    UNION ALL

	SELECT 13 + (SELECT COUNT(*) FROM PMIS_RES.MilReadiness WHERE MilReadinessCmdType IS NOT NULL)  +
        (SELECT COUNT(*)
         FROM (SELECT AdministrationGroup 
               FROM PMIS_ADM.Administrations 
               WHERE AdministrationGroup IS NOT NULL 
                     AND NVL(IsMinistryOfDefence, 0) = 0 
               GROUP BY AdministrationGroup) adm_cnt) +
        (SELECT COUNT(*)
         FROM (  
            SELECT a.administrationgroup, mr.milreadinesscmdtype
            FROM PMIS_ADM.Administrations a
            INNER JOIN PMIS_RES.MilReadiness mr ON mr.administrationid = a.administrationid OR mr.administrationid is null
            WHERE administrationgroup IS NOT NULL
            GROUP BY a.administrationgroup, mr.milreadinesscmdtype
         HAVING MAX(reporta33breakdown)  > 0) adm_readiness_cnt ) as StatusID,
		   'Всичко с МН за силите от системата за национална сигурност' as StatusName,
		   13 + (SELECT COUNT(*) FROM PMIS_RES.MilReadiness WHERE MilReadinessCmdType IS NOT NULL)  +
        (SELECT COUNT(*)
         FROM (SELECT AdministrationGroup 
               FROM PMIS_ADM.Administrations 
               WHERE AdministrationGroup IS NOT NULL 
                     AND NVL(IsMinistryOfDefence, 0) = 0 
               GROUP BY AdministrationGroup) adm_cnt) +
        (SELECT COUNT(*)
         FROM (  
            SELECT a.administrationgroup, mr.milreadinesscmdtype
            FROM PMIS_ADM.Administrations a
            INNER JOIN PMIS_RES.MilReadiness mr ON mr.administrationid = a.administrationid OR mr.administrationid is null
            WHERE administrationgroup IS NOT NULL
            GROUP BY a.administrationgroup, mr.milreadinesscmdtype
         HAVING MAX(reporta33breakdown)  > 0) adm_readiness_cnt ) as StatusOrder,
		   0 as MilReadinessID,
		   TO_CHAR('') as AdministrationGroup,
       '' as RowNumber,
       0 as IsEmtpyRow,
       0 as IsMinistryOfDefence
	FROM dual
    
    UNION ALL

	SELECT 14 + (SELECT COUNT(*) FROM PMIS_RES.MilReadiness WHERE MilReadinessCmdType IS NOT NULL)  +
        (SELECT COUNT(*)
         FROM (SELECT AdministrationGroup 
               FROM PMIS_ADM.Administrations 
               WHERE AdministrationGroup IS NOT NULL 
                     AND NVL(IsMinistryOfDefence, 0) = 0 
               GROUP BY AdministrationGroup) adm_cnt) +
        (SELECT COUNT(*)
         FROM (  
            SELECT a.administrationgroup, mr.milreadinesscmdtype
            FROM PMIS_ADM.Administrations a
            INNER JOIN PMIS_RES.MilReadiness mr ON mr.administrationid = a.administrationid OR mr.administrationid is null
            WHERE administrationgroup IS NOT NULL
            GROUP BY a.administrationgroup, mr.milreadinesscmdtype
         HAVING MAX(reporta33breakdown)  > 0) adm_readiness_cnt ) as StatusID,
		   'Отсрочени' as StatusName,
		   14 + (SELECT COUNT(*) FROM PMIS_RES.MilReadiness WHERE MilReadinessCmdType IS NOT NULL)  +
        (SELECT COUNT(*)
         FROM (SELECT AdministrationGroup 
               FROM PMIS_ADM.Administrations 
               WHERE AdministrationGroup IS NOT NULL 
                     AND NVL(IsMinistryOfDefence, 0) = 0 
               GROUP BY AdministrationGroup) adm_cnt) +
        (SELECT COUNT(*)
         FROM (  
            SELECT a.administrationgroup, mr.milreadinesscmdtype
            FROM PMIS_ADM.Administrations a
            INNER JOIN PMIS_RES.MilReadiness mr ON mr.administrationid = a.administrationid OR mr.administrationid is null
            WHERE administrationgroup IS NOT NULL
            GROUP BY a.administrationgroup, mr.milreadinesscmdtype
         HAVING MAX(reporta33breakdown)  > 0) adm_readiness_cnt ) as StatusOrder,
		   0 as MilReadinessID,
		   TO_CHAR('') as AdministrationGroup,
       '3.3.' as RowNumber,
       0 as IsEmtpyRow,
       NULL as IsMinistryOfDefence
	FROM dual
    
    UNION ALL

	SELECT 15 + (SELECT COUNT(*) FROM PMIS_RES.MilReadiness WHERE MilReadinessCmdType IS NOT NULL)  +
        (SELECT COUNT(*)
         FROM (SELECT AdministrationGroup 
               FROM PMIS_ADM.Administrations 
               WHERE AdministrationGroup IS NOT NULL 
                     AND NVL(IsMinistryOfDefence, 0) = 0 
               GROUP BY AdministrationGroup) adm_cnt) +
        (SELECT COUNT(*)
         FROM (  
            SELECT a.administrationgroup, mr.milreadinesscmdtype
            FROM PMIS_ADM.Administrations a
            INNER JOIN PMIS_RES.MilReadiness mr ON mr.administrationid = a.administrationid OR mr.administrationid is null
            WHERE administrationgroup IS NOT NULL
            GROUP BY a.administrationgroup, mr.milreadinesscmdtype
         HAVING MAX(reporta33breakdown)  > 0) adm_readiness_cnt ) as StatusID,
		   'Временно отписани' as StatusName,
		   15 + (SELECT COUNT(*) FROM PMIS_RES.MilReadiness WHERE MilReadinessCmdType IS NOT NULL)  +
        (SELECT COUNT(*)
         FROM (SELECT AdministrationGroup 
               FROM PMIS_ADM.Administrations 
               WHERE AdministrationGroup IS NOT NULL 
                     AND NVL(IsMinistryOfDefence, 0) = 0 
               GROUP BY AdministrationGroup) adm_cnt) +
        (SELECT COUNT(*)
         FROM (  
            SELECT a.administrationgroup, mr.milreadinesscmdtype
            FROM PMIS_ADM.Administrations a
            INNER JOIN PMIS_RES.MilReadiness mr ON mr.administrationid = a.administrationid OR mr.administrationid is null
            WHERE administrationgroup IS NOT NULL
            GROUP BY a.administrationgroup, mr.milreadinesscmdtype
         HAVING MAX(reporta33breakdown)  > 0) adm_readiness_cnt ) as StatusOrder,
		   0 as MilReadinessID,
		   TO_CHAR('') as AdministrationGroup,
       '3.4.' as RowNumber,
       0 as IsEmtpyRow,
       NULL as IsMinistryOfDefence
	FROM dual
    
    UNION ALL

	SELECT 16 + (SELECT COUNT(*) FROM PMIS_RES.MilReadiness WHERE MilReadinessCmdType IS NOT NULL)  +
        (SELECT COUNT(*)
         FROM (SELECT AdministrationGroup 
               FROM PMIS_ADM.Administrations 
               WHERE AdministrationGroup IS NOT NULL 
                     AND NVL(IsMinistryOfDefence, 0) = 0 
               GROUP BY AdministrationGroup) adm_cnt) +
        (SELECT COUNT(*)
         FROM (  
            SELECT a.administrationgroup, mr.milreadinesscmdtype
            FROM PMIS_ADM.Administrations a
            INNER JOIN PMIS_RES.MilReadiness mr ON mr.administrationid = a.administrationid OR mr.administrationid is null
            WHERE administrationgroup IS NOT NULL
            GROUP BY a.administrationgroup, mr.milreadinesscmdtype
         HAVING MAX(reporta33breakdown)  > 0) adm_readiness_cnt ) as StatusID,
		   'Свободни' as StatusName,
		   16 + (SELECT COUNT(*) FROM PMIS_RES.MilReadiness WHERE MilReadinessCmdType IS NOT NULL)  +
        (SELECT COUNT(*)
         FROM (SELECT AdministrationGroup 
               FROM PMIS_ADM.Administrations 
               WHERE AdministrationGroup IS NOT NULL 
                     AND NVL(IsMinistryOfDefence, 0) = 0 
               GROUP BY AdministrationGroup) adm_cnt) +
        (SELECT COUNT(*)
         FROM (  
            SELECT a.administrationgroup, mr.milreadinesscmdtype
            FROM PMIS_ADM.Administrations a
            INNER JOIN PMIS_RES.MilReadiness mr ON mr.administrationid = a.administrationid OR mr.administrationid is null
            WHERE administrationgroup IS NOT NULL
            GROUP BY a.administrationgroup, mr.milreadinesscmdtype
         HAVING MAX(reporta33breakdown)  > 0) adm_readiness_cnt ) as StatusOrder,
		   0 as MilReadinessID,
		   TO_CHAR('') as AdministrationGroup,
       '3.5.' as RowNumber,
       0 as IsEmtpyRow,
       NULL as IsMinistryOfDefence
	FROM dual;

/	
